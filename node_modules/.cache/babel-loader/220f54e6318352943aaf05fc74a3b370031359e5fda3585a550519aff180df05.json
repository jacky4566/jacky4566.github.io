{"ast":null,"code":"import { LEVEL_THEMES, PLACEMENT_TYPE_FLOUR, PLACEMENT_TYPE_GOAL, PLACEMENT_TYPE_HERO, PLACEMENT_TYPE_WALL } from \"../helpers/consts\";\nimport { placementFactory } from \"./PlacementFactory\";\nimport { GameLoop } from \"./GameLoop\";\nimport { DirectionControls } from \"./DirectionControls\";\nexport class LevelState {\n  constructor(levelId, onEmit) {\n    this.id = levelId;\n    this.onEmit = onEmit;\n    this.directionControls = new DirectionControls();\n\n    //Start the level!\n    this.start();\n  }\n  start() {\n    this.theme = LEVEL_THEMES.BLUE;\n    this.tilesWidth = 14;\n    this.tilesHeight = 22;\n    this.placements = [{\n      x: 2,\n      y: 2,\n      type: PLACEMENT_TYPE_HERO\n    }, {\n      x: 6,\n      y: 4,\n      type: PLACEMENT_TYPE_GOAL\n    }, {\n      x: 4,\n      y: 4,\n      type: PLACEMENT_TYPE_WALL\n    }, {\n      x: 5,\n      y: 2,\n      type: PLACEMENT_TYPE_WALL\n    }, {\n      x: 6,\n      y: 6,\n      type: PLACEMENT_TYPE_WALL\n    }, {\n      x: 3,\n      y: 3,\n      type: PLACEMENT_TYPE_FLOUR\n    }, {\n      x: 4,\n      y: 3,\n      type: PLACEMENT_TYPE_FLOUR\n    }, {\n      x: 5,\n      y: 3,\n      type: PLACEMENT_TYPE_FLOUR\n    }].map(config => {\n      return placementFactory.createPlacement(config, this);\n    });\n\n    // Cache a reference to the hero\n    this.heroRef = this.placements.find(p => p.type === PLACEMENT_TYPE_HERO);\n    this.startGameLoop();\n  }\n  startGameLoop() {\n    var _this$gameLoop;\n    (_this$gameLoop = this.gameLoop) === null || _this$gameLoop === void 0 ? void 0 : _this$gameLoop.stop();\n    this.gameLoop = new GameLoop(() => {\n      this.tick();\n    });\n  }\n  addPlacement(config) {\n    this.placements.push(placementFactory.createPlacement(config, this));\n  }\n  deletePlacement(placementToRemove) {\n    this.placements = this.placements.filter(p => {\n      return p.id !== placementToRemove.id;\n    });\n  }\n  tick() {\n    // Check for movement here...\n    if (this.directionControls.direction) {\n      this.heroRef.controllerMoveRequested(this.directionControls.direction);\n    }\n\n    // Call 'tick' on any Placement that wants to update\n    this.placements.forEach(placement => {\n      placement.tick();\n    });\n\n    //Emit any changes to React\n    this.onEmit(this.getState());\n  }\n  isPositionOutOfBounds(x, y) {\n    return x === 0 || y === 0 || x >= this.tilesWidth + 1 || y >= this.tilesHeight + 1;\n  }\n  getState() {\n    return {\n      theme: this.theme,\n      tilesWidth: this.tilesWidth,\n      tilesHeight: this.tilesHeight,\n      placements: this.placements\n    };\n  }\n  destroy() {\n    // Tear down the level.\n    this.gameLoop.stop();\n    this.directionControls.unbind();\n  }\n}","map":{"version":3,"names":["LEVEL_THEMES","PLACEMENT_TYPE_FLOUR","PLACEMENT_TYPE_GOAL","PLACEMENT_TYPE_HERO","PLACEMENT_TYPE_WALL","placementFactory","GameLoop","DirectionControls","LevelState","constructor","levelId","onEmit","id","directionControls","start","theme","BLUE","tilesWidth","tilesHeight","placements","x","y","type","map","config","createPlacement","heroRef","find","p","startGameLoop","_this$gameLoop","gameLoop","stop","tick","addPlacement","push","deletePlacement","placementToRemove","filter","direction","controllerMoveRequested","forEach","placement","getState","isPositionOutOfBounds","destroy","unbind"],"sources":["C:/GitHub/AthabascaCPSCI/COMP 486/Mineral Mayhem/mineralmayhem/src/classes/LevelState.js"],"sourcesContent":["import {\r\n    LEVEL_THEMES,\r\n    PLACEMENT_TYPE_FLOUR,\r\n    PLACEMENT_TYPE_GOAL,\r\n    PLACEMENT_TYPE_HERO,\r\n    PLACEMENT_TYPE_WALL,\r\n  } from \"../helpers/consts\";\r\nimport { placementFactory } from \"./PlacementFactory\";\r\nimport { GameLoop } from \"./GameLoop\";\r\nimport { DirectionControls } from \"./DirectionControls\";\r\n\r\nexport class LevelState {\r\n  constructor(levelId, onEmit) {\r\n    this.id = levelId;\r\n    this.onEmit = onEmit;\r\n    this.directionControls = new DirectionControls();\r\n\r\n    //Start the level!\r\n    this.start();\r\n  }\r\n\r\n  start() {\r\n    this.theme = LEVEL_THEMES.BLUE;\r\n    this.tilesWidth = 14;\r\n    this.tilesHeight = 22;\r\n    this.placements = [\r\n      { x: 2, y: 2, type: PLACEMENT_TYPE_HERO },\r\n      { x: 6, y: 4, type: PLACEMENT_TYPE_GOAL },\r\n      { x: 4, y: 4, type: PLACEMENT_TYPE_WALL },\r\n      { x: 5, y: 2, type: PLACEMENT_TYPE_WALL },\r\n      { x: 6, y: 6, type: PLACEMENT_TYPE_WALL },\r\n      { x: 3, y: 3, type: PLACEMENT_TYPE_FLOUR },\r\n      { x: 4, y: 3, type: PLACEMENT_TYPE_FLOUR },\r\n      { x: 5, y: 3, type: PLACEMENT_TYPE_FLOUR },\r\n      ].map((config) => {\r\n        return placementFactory.createPlacement(config, this);\r\n      });\r\n\r\n     // Cache a reference to the hero\r\n     this.heroRef = this.placements.find((p) => p.type === PLACEMENT_TYPE_HERO);\r\n\r\n\r\n      this.startGameLoop();\r\n  }\r\n\r\n  startGameLoop() {\r\n    this.gameLoop?.stop();\r\n    this.gameLoop = new GameLoop(() => {\r\n      this.tick();\r\n    });\r\n  }\r\n\r\n  addPlacement(config) {\r\n    this.placements.push(placementFactory.createPlacement(config, this));\r\n  }\r\n\r\n  deletePlacement(placementToRemove) {\r\n    this.placements = this.placements.filter((p) => {\r\n      return p.id !== placementToRemove.id;\r\n    });\r\n  }\r\n\r\n  tick() {\r\n    // Check for movement here...\r\n    if (this.directionControls.direction) {\r\n      this.heroRef.controllerMoveRequested(this.directionControls.direction);\r\n    }\r\n    \r\n    // Call 'tick' on any Placement that wants to update\r\n    this.placements.forEach((placement) => {\r\n      placement.tick();\r\n    });\r\n\r\n    //Emit any changes to React\r\n    this.onEmit(this.getState());\r\n  }\r\n\r\n  isPositionOutOfBounds(x, y) {\r\n    return (\r\n      x === 0 ||\r\n      y === 0 ||\r\n      x >= this.tilesWidth + 1 ||\r\n      y >= this.tilesHeight + 1\r\n    );\r\n  }\r\n\r\n  getState() {\r\n    return {\r\n      theme: this.theme,\r\n      tilesWidth: this.tilesWidth,\r\n      tilesHeight: this.tilesHeight,\r\n      placements: this.placements,\r\n    };\r\n  }\r\n\r\n  destroy() {\r\n    // Tear down the level.\r\n    this.gameLoop.stop();\r\n    this.directionControls.unbind();\r\n  }\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}